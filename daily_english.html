<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>„Åæ„ÅÑ„Å´„Å°„Ç®„Ç§„Ç¥</title>
    <script src="ranking.js"></script>
    <style>
        body {
            font-family: "UD Digital Kyokasho-tai-R", "Hiragino Kaku Gothic ProN", sans-serif;
            background-color: #fff3e0;
            /* „ÇÑ„Åï„Åó„ÅÑ„Ç™„É¨„É≥„Ç∏ */
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            height: 100dvh;
            margin: 0;
            overflow: hidden;
            touch-action: manipulation;
            user-select: none;
        }

        #game-container {
            text-align: center;
            background: white;
            padding: 20px;
            border-radius: 30px;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
            width: 90%;
            max-width: 600px;
            position: relative;
            height: 90vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .screen {
            display: none;
            width: 100%;
            height: 100%;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .active {
            display: flex;
        }

        h1 {
            color: #ff9800;
            font-size: 28px;
            margin-bottom: 10px;
        }

        /* ÂïèÈ°åË°®Á§∫„Ç®„É™„Ç¢ */
        .question-area {
            background: #fff8e1;
            border: 3px solid #ffcc80;
            border-radius: 20px;
            padding: 30px 20px;
            margin: 20px 0;
            width: 90%;
            box-sizing: border-box;
        }

        .situation-text {
            font-size: 24px;
            font-weight: bold;
            color: #333;
            line-height: 1.5;
        }

        /* ÈÅ∏ÊäûËÇ¢„Éú„Çø„É≥ */
        .choices-area {
            display: flex;
            flex-direction: column;
            gap: 15px;
            width: 90%;
            margin-top: 10px;
        }

        .choice-btn {
            background: #e3f2fd;
            border: 2px solid #90caf9;
            border-radius: 15px;
            padding: 15px;
            font-size: 18px;
            font-weight: bold;
            color: #1565c0;
            cursor: pointer;
            transition: transform 0.1s;
            text-align: left;
            position: relative;
        }

        .choice-btn:active {
            transform: scale(0.98);
            background: #bbdefb;
        }

        .english-text {
            font-size: 22px;
            display: block;
            margin-bottom: 5px;
        }

        .kana-text {
            font-size: 14px;
            color: #555;
            display: block;
        }

        /* ÂÖ±ÈÄö„Éú„Çø„É≥ */
        .start-btn,
        .retry-btn,
        .next-btn {
            font-size: 24px;
            padding: 15px 50px;
            color: white;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-family: inherit;
            font-weight: bold;
            box-shadow: 0 5px rgba(0, 0, 0, 0.2);
            margin-top: 20px;
        }

        .start-btn {
            background: #ff9800;
        }

        .retry-btn {
            background: #4caf50;
        }

        .next-btn {
            background: #2196f3;
            display: none;
        }

        /* ÂàùÊúü„ÅØÈùûË°®Á§∫ */

        .back-btn {
            background: #90a4ae;
            font-size: 14px;
            padding: 8px 20px;
            color: white;
            border-radius: 20px;
            text-decoration: none;
            display: inline-block;
            margin-top: 20px;
            box-shadow: 0 4px #78909c;
        }

        /* UI„Éë„Éº„ÉÑ */
        .hud {
            display: flex;
            justify-content: space-between;
            width: 90%;
            font-size: 18px;
            font-weight: bold;
            color: #555;
            margin-bottom: 10px;
        }

        /* Ê≠£Ëß£„Éª‰∏çÊ≠£Ëß£„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥ */
        .feedback {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 150px;
            display: none;
            z-index: 100;
            text-shadow: 3px 3px 0 white;
            pointer-events: none;
        }

        /* ‰∏çÊ≠£Ëß£ÊôÇ„ÅÆ„Éú„Çø„É≥„Çπ„Çø„Ç§„É´ */
        .wrong-btn {
            background-color: #ffcdd2;
            border-color: #ef5350;
            color: #b71c1c;
            opacity: 0.6;
            pointer-events: none;
            /* Êäº„Åõ„Å™„Åè„Åô„Çã */
        }

        /* Ê≠£Ëß£ÊôÇ„ÅÆ„Éú„Çø„É≥„Çπ„Çø„Ç§„É´ */
        .correct-btn {
            background-color: #c8e6c9;
            border-color: #66bb6a;
            color: #1b5e20;
        }
    </style>
</head>

<body>

    <div id="game-container">
        <div id="feedback-mark" class="feedback">‚≠ï</div>

        <!-- „Çπ„Çø„Éº„ÉàÁîªÈù¢ -->
        <div id="start-screen" class="screen active">
            <div style="font-size: 80px;">üó£Ô∏è</div>
            <h1>„Åæ„ÅÑ„Å´„Å°„Ç®„Ç§„Ç¥</h1>
            <p>„Åà„ÅÑ„Åî„Åß „ÅÇ„ÅÑ„Åï„Å§ „Åß„Åç„Çã„Åã„Å™Ôºü<br>„Åü„Å†„Åó„ÅÑ „Åà„ÅÑ„Åî„Çí „Åà„Çâ„Çì„Åß„Å≠ÔºÅ</p>
            <button class="start-btn" onclick="startGame()">„Çπ„Çø„Éº„ÉàÔºÅ</button>
            <br>
            <a href="index.html" class="back-btn">üè† „ÇÇ„Å©„Çã</a>
        </div>

        <!-- „Ç≤„Éº„É†ÁîªÈù¢ -->
        <div id="quiz-screen" class="screen">
            <div class="hud">
                <span id="timer-display">0.0„Å≥„Çá„ÅÜ</span>
                <span id="progress">1 / 10</span>
            </div>

            <div class="question-area">
                <div id="situation-text" class="situation-text">„Åì„Åì„Å´ „ÇÇ„Çì„Å†„ÅÑ „Åå „Åß„Åæ„Åô</div>
            </div>

            <div id="choices-area" class="choices-area">
                <!-- „Éú„Çø„É≥„ÅØJS„ÅßÁîüÊàê -->
            </div>

            <a href="index.html" class="back-btn" style="background:#cfd8dc; color:#555;">üè† „ÇÑ„ÇÅ„Çã</a>
        </div>

        <!-- „É™„Ç∂„É´„ÉàÁîªÈù¢ -->
        <div id="result-screen" class="screen">
            <h1>‚ú® „ÇØ„É™„Ç¢ÔºÅ ‚ú®</h1>
            <div style="font-size: 60px;">üíÆ</div>
            <p>„Åã„Åã„Å£„Åü „Åò„Åã„Çì</p>
            <div id="final-time" style="font-size:36px; color:#e91e63; font-weight:bold;">0.0„Å≥„Çá„ÅÜ</div>

            <button class="retry-btn" onclick="startGame()">„ÇÇ„ÅÜ„ÅÑ„Å£„Åã„ÅÑÔºÅ</button>
            <br>
            <a href="index.html" class="back-btn">üè† „ÇÇ„Å©„Çã</a>
        </div>
    </div>

    <script>
        // ‚ñº‚ñº‚ñº ÂïèÈ°å„Éá„Éº„Çø ‚ñº‚ñº‚ñº
        const ALL_QUESTIONS = [
            // 1. 1Êó•„ÅÆÊµÅ„Çå
            { t: "„ÅÇ„Åï„ÄÅ„Åä„Åç„Åü„Çâ „Éë„Éë„Å®„Éû„Éû„Å´ „Å™„Çì„Å¶„ÅÑ„ÅÜÔºü", e: "Good morning.", k: "„Ç∞„ÉÉ„Éâ „É¢„Éº„Éã„É≥„Ç∞" },
            { t: "„Åî„ÅØ„Çì„Çí „Åü„Åπ„Çã„Åæ„Åà„Å´ „ÅÑ„ÅÜ „Åì„Å®„Å∞„ÅØÔºü", e: "Let's eat.", k: "„É¨„ÉÉ„ÉÑ „Ç§„Éº„Éà" },
            { t: "„Äå„ÅÑ„Å£„Å¶„Åç„Åæ„Åô„Äç„ÅØ „Åà„ÅÑ„Åî„ÅßÔºü", e: "See you later.", k: "„Ç∑„Éº „É¶„Éº „É¨„Ç§„Çø„Éº" },
            { t: "„Åä„ÅÜ„Å°„Å´ „Åã„Åà„Å£„Å¶„Åç„Åü„Å®„Åç„ÅÆ„Äå„Åü„Å†„ÅÑ„Åæ„Äç„ÅØÔºü", e: "I'm home.", k: "„Ç¢„Ç§„É† „Éõ„Éº„É†" },
            { t: "„Å≠„Çã„Åæ„Åà„ÅÆ „ÅÇ„ÅÑ„Åï„Å§„Äå„Åä„ÇÑ„Åô„Åø„Å™„Åï„ÅÑ„Äç„ÅØÔºü", e: "Good night.", k: "„Ç∞„ÉÉ„Éâ „Éä„Ç§„Éà" },
            { t: "„Åó„ÇÖ„Åè„Å†„ÅÑ„Åå „Åä„Çè„Å£„Åü„Åì„Å®„Çí „Å§„Åü„Åà„Çà„ÅÜÔºÅ", e: "I finished my homework.", k: "„Ç¢„Ç§ „Éï„Ç£„Éã„ÉÉ„Ç∑„É•„Éâ „Éû„Ç§ „Éõ„Éº„É†„ÉØ„Éº„ÇØ" },
            { t: "„Åì„Çå„Åã„Çâ „Éû„Éû„Å® „Åã„ÅÑ„ÇÇ„ÅÆ„Å´ „ÅÑ„Åè„Åì„Å®„Çí „Å§„Åü„Åà„Çà„ÅÜÔºÅ", e: "I'm going shopping with Mom.", k: "„Ç¢„Ç§„É† „Ç¥„Éº„Ç§„É≥„Ç∞ „Ç∑„Éß„ÉÉ„Éî„É≥„Ç∞ „Ç¶„Ç£„Ç∫ „Éû„É†" },

            // 2. „ÅäÂ∫óÂ±ã„Åï„Çì
            { t: "„Åä„Åø„Åõ„Åß„Äå„Åì„Çå„Çí „Åè„Å†„Åï„ÅÑ„Äç„Å® „ÅÑ„ÅÜ„Å®„Åç„ÅØÔºü", e: "This one, please.", k: "„Éá„Ç£„Çπ „ÉØ„É≥ „Éó„É™„Éº„Ç∫" },
            { t: "„ÇÇ„ÅÆ„Çí „Çè„Åü„Åô„Å®„Åç„ÅÆ„Äå„ÅØ„ÅÑ„ÄÅ„Å©„ÅÜ„Åû„Äç„ÅØÔºü", e: "Here you are.", k: "„Éí„Ç¢ „É¶„Éº „Ç¢„Éº" },
            { t: "„Äå„ÅÇ„Çä„Åå„Å®„ÅÜ„Äç„Å® „ÅÑ„ÅÑ„Åü„ÅÑ„Å®„Åç„ÅØÔºü", e: "Thank you.", k: "„Çµ„É≥„Ç≠„É•„Éº" },
            { t: "„Äå„ÅÇ„Çä„Åå„Å®„ÅÜ„Äç„Å® „ÅÑ„Çè„Çå„Åü„Çâ „Å™„Çì„Å¶ „Åã„Åà„ÅôÔºü", e: "You're welcome.", k: "„É¶„Ç¢ „Ç¶„Çß„É´„Ç´„É†" },
            { t: "„Å≠„Å†„Çì„Çí „Åç„Åè„Å®„Åç„ÅÆ„Äå„ÅÑ„Åè„Çâ„Åß„Åô„ÅãÔºü„Äç„ÅØÔºü", e: "How much?", k: "„Éè„Ç¶ „Éû„ÉÉ„ÉÅÔºü" },

            // 3. Ê∞óÊåÅ„Å°„ÉªÁä∂ÊÖã
            { t: "„Äå„Åä„Å™„Åã„Åå „Åô„ÅÑ„Åü„Çà„Äç„Å® „Å§„Åü„Åà„Çà„ÅÜ", e: "I'm hungry.", k: "„Ç¢„Ç§„É† „Éè„É≥„Ç∞„É™„Éº" },
            { t: "„Äå„Å≠„ÇÄ„ÅÑ„Çà„Äç„Å® „Å§„Åü„Åà„Çà„ÅÜ", e: "I'm sleepy.", k: "„Ç¢„Ç§„É† „Çπ„É™„Éº„Éî„Éº" },
            { t: "„Ç±„Ç¨„Çí„Åó„Å¶„Äå„ÅÑ„Åü„ÅÑÔºÅ„Äç„Å®„Åç„ÅØÔºü", e: "Ouch!", k: "„Ç¢„Ç¶„ÉÅÔºÅ" },
            { t: "„Åì„Åæ„Å£„Åü„Å®„Åç„Äå„Åü„Åô„Åë„Å¶ÔºÅ„Äç„Å® „ÅÑ„ÅÜ„Å®„Åç„ÅØÔºü", e: "Help me.", k: "„Éò„É´„Éó „Éü„Éº" },
            { t: "„Äå„ÅÜ„Çå„Åó„ÅÑÔºÅ„Äç„Å®„ÅÑ„ÅÜ „Åç„ÇÇ„Å°„ÅØÔºü", e: "I'm happy.", k: "„Ç¢„Ç§„É† „Éè„ÉÉ„Éî„Éº" },

            // 4. „Åä„Åó„ÇÉ„Åπ„Çä
            { t: "„Äå„Åì„ÅÆ„Éö„É≥ „Åç„ÅÆ„ÅÜ „Åã„Å£„Åü„ÅÆ„Äç„Å® „ÅÑ„ÅÑ„Åü„ÅÑ„Å®„Åç„ÅØÔºü", e: "I bought this pen yesterday.", k: "„Ç¢„Ç§ „Éú„Éº„Éà „Éá„Ç£„Çπ „Éö„É≥ „Ç§„Ç®„Çπ„Çø„Éá„Ç§" },
            { t: "„Åä„Å®„ÇÇ„Å†„Å°„ÅÆ „Åã„Åø„Åã„Åñ„Çä„Åå „Åã„Çè„ÅÑ„ÅÑ„Å®„Åç„ÅØÔºü", e: "That hair accessory is cute.", k: "„Ç∂„ÉÉ„Éà „Éò„Ç¢ „Ç¢„ÇØ„Çª„Çµ„É™„Éº „Ç§„Ç∫ „Ç≠„É•„Éº„Éà" },
            { t: "„Éë„É≥„ÇÑ„Åï„Çì„ÅÆ „Éë„É≥„Åå „Åä„ÅÑ„Åó„Åù„ÅÜ„Å™„Å®„Åç„ÅØÔºü", e: "That bread looks delicious.", k: "„Ç∂„ÉÉ„Éà „Éñ„É¨„ÉÉ„Éâ „É´„ÉÉ„ÇØ„Çπ „Éá„É™„Ç∑„É£„Çπ" },
            { t: "„ÅÇ„Åó„Åü„ÅØ „Åì„ÅÜ„Åà„Çì„Å´ „ÅÑ„Åç„Åü„ÅÑ„Å™", e: "I want to go to the park tomorrow.", k: "„Ç¢„Ç§ „Ç¶„Ç©„É≥„Éà „Éà„Ç• „Ç¥„Éº „Éà„Ç• „Ç∂ „Éë„Éº„ÇØ „Éà„Ç•„É¢„É≠„Éº" }
        ];

        const MAX_QUESTIONS = 10;
        let currentQuestions = [];
        let currentIndex = 0;
        let startTime, timerInterval;
        let canClick = true;

        function changeScreen(id) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById(id).classList.add('active');
        }

        function startGame() {
            // „É©„É≥„ÉÄ„É†„Å´10ÂïèÈÅ∏Âá∫
            currentQuestions = shuffleArray(ALL_QUESTIONS).slice(0, MAX_QUESTIONS);
            currentIndex = 0;
            canClick = true;

            changeScreen('quiz-screen');
            startTimer();
            showQuestion();
        }

        function startTimer() {
            startTime = Date.now();
            timerInterval = setInterval(() => {
                const t = ((Date.now() - startTime) / 1000).toFixed(1);
                document.getElementById('timer-display').textContent = t + "„Å≥„Çá„ÅÜ";
            }, 100);
        }

        function stopTimer() {
            clearInterval(timerInterval);
            return ((Date.now() - startTime) / 1000).toFixed(1);
        }

        function showQuestion() {
            const q = currentQuestions[currentIndex];
            document.getElementById('progress').textContent = `${currentIndex + 1} / ${MAX_QUESTIONS}`;
            document.getElementById('situation-text').textContent = q.t;

            const area = document.getElementById('choices-area');
            area.innerHTML = '';

            // Ë™§Á≠î„ÅÆÈÅ∏ÊäûËÇ¢„Çí‰ΩúÊàêÔºà‰ªä„ÅÆÊ≠£Ëß£‰ª•Â§ñ„Åã„Çâ„É©„É≥„ÉÄ„É†„Å´2„Å§ÈÅ∏„Å∂Ôºâ
            const others = ALL_QUESTIONS.filter(item => item.e !== q.e);
            const wrongChoices = shuffleArray(others).slice(0, 2);

            // Ê≠£Ëß£ + Ë™§Á≠î2„Å§ „ÇíÊ∑∑„Åú„Çã
            const choices = shuffleArray([q, ...wrongChoices]);

            choices.forEach(choice => {
                const btn = document.createElement('button');
                btn.className = 'choice-btn';
                btn.innerHTML = `<span class="english-text">${choice.e}</span><span class="kana-text">${choice.k}</span>`;

                // Ê≠£Ëß£„Åã„Å©„ÅÜ„ÅãÂà§ÂÆöÁî®
                btn.onclick = () => checkAnswer(choice, btn);
                area.appendChild(btn);
            });

            canClick = true;
        }

        function checkAnswer(selected, btnElement) {
            if (!canClick) return;

            const correct = currentQuestions[currentIndex];
            const feedback = document.getElementById('feedback-mark');

            if (selected.e === correct.e) {
                // Ê≠£Ëß£ÔºÅ
                canClick = false; // ÈÄ£ÊâìÈò≤Ê≠¢
                btnElement.classList.add('correct-btn');
                feedback.textContent = '‚≠ï';
                feedback.style.color = '#ff3d00';
                feedback.style.display = 'block';

                setTimeout(() => {
                    feedback.style.display = 'none';
                    currentIndex++;
                    if (currentIndex >= MAX_QUESTIONS) {
                        finishGame();
                    } else {
                        showQuestion();
                    }
                }, 800);

            } else {
                // ‰∏çÊ≠£Ëß£
                btnElement.classList.add('wrong-btn'); // Ëµ§„Åè„Åó„Å¶Êäº„Åõ„Å™„Åè„Åô„Çã
                feedback.textContent = '‚ùå';
                feedback.style.color = '#555';
                feedback.style.display = 'block';

                setTimeout(() => {
                    feedback.style.display = 'none';
                    // „Éö„Éä„É´„ÉÜ„Ç£„Å™„Åó„ÅßÂÜçÈÅ∏ÊäûÂèØËÉΩÔºàcanClick„ÅØtrue„ÅÆ„Åæ„ÅæÔºâ
                }, 500);
            }
        }

        function finishGame() {
            const time = stopTimer();
            document.getElementById('final-time').textContent = time + "„Å≥„Çá„ÅÜ";
            changeScreen('result-screen');

            if (typeof showSaveDialog === 'function') {
                showSaveDialog('daily_english', time);
            }
        }

        // ÈÖçÂàó„Ç∑„É£„ÉÉ„Éï„É´Áî®
        function shuffleArray(array) {
            const clone = array.slice();
            for (let i = clone.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [clone[i], clone[j]] = [clone[j], clone[i]];
            }
            return clone;
        }

        // „ÉÄ„Éñ„É´„Çø„ÉÉ„ÉóÊã°Â§ßÈò≤Ê≠¢
        document.addEventListener('dblclick', function (event) {
            event.preventDefault();
        }, { passive: false });
    </script>

</body>

</html>